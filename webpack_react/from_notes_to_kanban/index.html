<html lang="en"><head><title>SurviveJS - From Notes to Kanban</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui"><meta name="description" content="

So far we have managed to set up a nice little development environment. We have developed an application for keeping track of notes in localStorage. We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of Lane.

A Lane is soâ€¦"><meta name="keywords" content="webpack,react,javascript,programming,web development"><link rel="icon" type="image/png" href="../../assets/img/favicon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><link rel="stylesheet" href="../../assets/main.css"></head><body><div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog">Read the blog</a></div><div class="nav__link"><a href="https://leanpub.com/survivejs_webpack">Buy the full ebook</a></div><div class="nav__link"><a href=""></a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><div class="right ribbon github-fork-ribbon-wrapper"><div class="github-fork-ribbon" style="background-color:black;"><a href="https://github.com/survivejs/webpack_react/issues/new?title=From Notes to Kanban - " target="_blank">Submit feedback</a></div></div><main role="main"><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/images/kanban_photo.jpg);"></div><h1 class="post__heading">From Notes to Kanban</h1><div class="toc-nav__wrapper"><h4 class="toc-nav--header">Table of Contents</h4><div class="toc-nav"><a href="/webpack_react/introduction" class="toc-nav__link chapter">Introduction</a><a href="/webpack_react/webpack" class="toc-nav__link part">Setting Up Webpack</a><a href="/webpack_react/webpack_compared" class="toc-nav__link chapter">Webpack Compared</a><a href="/webpack_react/developing_with_webpack" class="toc-nav__link chapter">Developing with Webpack</a><a href="/webpack_react/webpack_and_react" class="toc-nav__link chapter">Webpack and React</a><a href="/webpack_react/react" class="toc-nav__link part">Developing Kanban Application</a><a href="/webpack_react/implementing_notes" class="toc-nav__link chapter">Implementing a Basic Note Application</a><a href="/webpack_react/react_and_flux" class="toc-nav__link chapter">React and Flux</a><span class="toc-nav__link toc-nav__link--current chapter">From Notes to Kanban</span><a href="/webpack_react/implementing_dnd" class="toc-nav__link chapter">Implementing Drag and Drop</a><a href="/webpack_react/building_kanban" class="toc-nav__link chapter">Building Kanban</a><a href="/webpack_react/testing_react" class="toc-nav__link chapter">Testing React*</a><a href="/webpack_react/typing_with_react" class="toc-nav__link chapter">Typing with React*</a><a href="/webpack_react/advanced" class="toc-nav__link part">Advanced Techniques</a><a href="/webpack_react/linting_in_webpack" class="toc-nav__link chapter">Linting in Webpack</a><a href="/webpack_react/authoring_libraries" class="toc-nav__link chapter">Authoring Libraries</a><a href="/webpack_react/styling_react" class="toc-nav__link chapter">Styling React</a><a href="/webpack_react/understanding_decorators" class="toc-nav__link chapter">Understanding Decorators</a><a href="/webpack_react/troubleshooting" class="toc-nav__link chapter">Troubleshooting</a></div></div><div class="chapter"><div class="post__content"><blockquote class="front__latestpost tip"><div>From the blog:</div><a class="front__latestpost-link" href="/blog/react-router5">react-router5 - Routing Alternative for React - Interview with Thomas Roch</a></blockquote><div class="post__meta"><a class="post__start_source" href="https://github.com/survivejs/webpack_react/tree/master/project_source/05_react_and_flux/kanban_app" target="_blank">Start source code</a><a class="post__end_source" href="https://github.com/survivejs/webpack_react/tree/master/project_source/06_from_notes_to_kanban/kanban_app" target="_blank">Finished source code</a><a class="post__demo" href="/demos/06_from_notes_to_kanban" target="_blank">Demo</a></div><div class="chapter-content"><p><img src="/images/kanban_05.png" alt="Kanban board"></p>
<p>So far we have managed to set up a nice little development environment. We have developed an application for keeping track of notes in <code>localStorage</code>. We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of <code>Lane</code>.</p>
<p>A <code>Lane</code> is something that should be able to contain many <code>Notes</code> within itself and track their order. One way to model this is simply to make a <code>Lane</code> point at <code>Notes</code> through an array of <code>Note</code> ids. This relation could be reversed. A <code>Note</code> could point at a <code>Lane</code> using an id and maintain information about its position within a <code>Lane</code>. In this case we are going to stick with the former design as that works well with re-ordering later on.</p>
<h2 class="header"><a class="header-anchor" href="#extracting-lanes-" id="extracting-lanes-"></a><span class="text">Extracting <code>Lanes</code></span><a class="header-anchor-select" href="#extracting-lanes-">#</a></h2>
<p>As earlier, we can use the same idea of two components here. There will be a component for the higher level (i.e., <code>Lanes</code>) and for the lower level (i.e., <code>Lane</code>). The higher level component will deal with lane ordering. A <code>Lane</code> will render itself (i.e., name and <code>Notes</code>) and have basic manipulation operations.</p>
<p>Just as with <code>Notes</code>, we are going to need a set of actions. For now it is enough if we can just create new lanes so we can create a corresponding action for that as below:</p>
<p><strong>app/actions/LaneActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">generateActions</span><span class="token punctuation">(</span><span class="token string">&apos;create&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>In addition, we are going to need a <code>LaneStore</code> and a method matching to <code>create</code>. The idea is pretty much the same as for <code>NoteStore</code> earlier. <code>create</code> will concatenate a new lane to the list of lanes. After that the change will propagate to the listeners (i.e., <code>FinalStore</code> and components).</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> uuid from <span class="token string">&apos;node-uuid&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LaneStore</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bindActions</span><span class="token punctuation">(</span>LaneActions<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>lanes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">create</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>

    lane<span class="token punctuation">.</span>id <span class="token operator">=</span> uuid<span class="token punctuation">.</span><span class="token function">v4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lane<span class="token punctuation">.</span>notes <span class="token operator">=</span> lane<span class="token punctuation">.</span>notes <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      lanes<span class="token punctuation">:</span> lanes<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>LaneStore<span class="token punctuation">,</span> <span class="token string">&apos;LaneStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We are also going to need a stub for <code>Lanes</code>. We will expand this later. For now we just want something simple to show up.</p>
<p><strong>app/components/Lanes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lanes</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lanes&quot;</span><span class="token operator">&gt;</span>
        lanes should go here
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Next we need to make room for <code>Lanes</code> at <code>App</code>. We will simply replace <code>Notes</code> references with <code>Lanes</code>, set up actions, and store as needed:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> AltContainer from <span class="token string">&apos;alt-container&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Lanes from <span class="token string">&apos;./Lanes.jsx&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneStore from <span class="token string">&apos;../stores/LaneStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">&quot;add-lane&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addItem<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>AltContainer
          stores<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>LaneStore<span class="token punctuation">]</span><span class="token punctuation">}</span>
          inject<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            items<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> LaneStore<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lanes <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Lanes <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>AltContainer<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    LaneActions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&apos;New lane&apos;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The current implementation doesn&apos;t do much. It just shows a plus button and <em>lanes should go here</em> text. Even the add button doesn&apos;t work yet. We still need to model <code>Lane</code> and attach <code>Notes</code> to that to make this all work.</p>
<h2 class="header"><a class="header-anchor" href="#modeling-lane-" id="modeling-lane-"></a><span class="text">Modeling <code>Lane</code></span><a class="header-anchor-select" href="#modeling-lane-">#</a></h2>
<p>The <code>Lanes</code> container will render each <code>Lane</code> separately. Each <code>Lane</code> in turn will then render associated <code>Notes</code> just like our <code>App</code> did earlier. <code>Lanes</code> is analogous to <code>Notes</code> in this manner. The example below illustrates how to set this up:</p>
<p><strong>app/components/Lanes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Lane from <span class="token string">&apos;./Lane.jsx&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lanes</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>items<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lanes&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>lanes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderLane<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">renderLane</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Lane className<span class="token operator">=</span><span class="token string">&quot;lane&quot;</span> key<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>id<span class="token punctuation">}</span> lane<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We are also going to need a <code>Lane</code> component to make this work. It will render the <code>Lane</code> name and associated <code>Notes</code>. The example below has been modeled largely after our earlier implementation of <code>App</code>. It will render an entire lane including its name and associated notes:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> AltContainer from <span class="token string">&apos;alt-container&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Notes from <span class="token string">&apos;./Notes.jsx&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteActions from <span class="token string">&apos;../actions/NoteActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteStore from <span class="token string">&apos;../stores/NoteStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lane</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>lane<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-header&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-name&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-add-note&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addNote<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>AltContainer
          stores<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>NoteStore<span class="token punctuation">]</span><span class="token punctuation">}</span>
          inject<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            items<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> NoteStore<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>notes <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Notes onEdit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>editNote<span class="token punctuation">}</span> onDelete<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>deleteNote<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>AltContainer<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addNote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NoteActions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>task<span class="token punctuation">:</span> <span class="token string">&apos;New task&apos;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">editNote</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NoteActions<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">,</span> task<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">deleteNote</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NoteActions<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>I am using <a href="https://github.com/sebmarkbage/ecmascript-rest-spread">Object rest spread syntax (stage 2)</a> (<code>{a, b, ...props} = this.props</code>) in the example. This allows us to attach a <code>className</code> to <code>Lane</code> and we avoid polluting it with HTML attributes we don&apos;t need. The syntax expands Object key value pairs as props so we don&apos;t have to write each prop we want separately.</p>
<p>If you run the application, you can see there&apos;s something wrong. If you add new <code>Notes</code> to a <code>Lane</code>, the <code>Note</code> appears to each <code>Lane</code>. Also if you modify a <code>Note</code>, the other <code>Lanes</code> update, too.</p>
<p><img src="/images/kanban_01.png" alt="Duplicate notes"></p>
<p>The reason why this happens is simple. Our <code>NoteStore</code> is a singleton. This means every component that is listening to <code>NoteStore</code> will receive the same data. We will need to resolve this problem.</p>
<h2 class="header"><a class="header-anchor" href="#making-lanes-responsible-of-notes-" id="making-lanes-responsible-of-notes-"></a><span class="text">Making <code>Lanes</code> Responsible of <code>Notes</code></span><a class="header-anchor-select" href="#making-lanes-responsible-of-notes-">#</a></h2>
<p>Currently our <code>Lane</code> model is simple. We are just storing an array of objects. Each of the objects knows its <em>id</em> and <em>name</em>. We&apos;ll need something more. Each <code>Lane</code> needs to know which <code>Notes</code> belong to it. If a <code>Lane</code> contained an array of <code>Note</code> ids, it could then filter and display the <code>Notes</code> belonging to it.</p>
<h3 class="header"><a class="header-anchor" href="#setting-up-attachtolane-" id="setting-up-attachtolane-"></a><span class="text">Setting Up <code>attachToLane</code></span><a class="header-anchor-select" href="#setting-up-attachtolane-">#</a></h3>
<p>When we add a new <code>Note</code> to the system using <code>addNote</code>, we need to make sure it&apos;s associated to some <code>Lane</code>. This association can be modeled using a method such as <code>LaneActions.attachToLane({laneId: &lt;id&gt;})</code>. As a <code>Note</code> needs to exist before this association can be made, this method needs to trigger <code>waitFor</code>.</p>
<p><code>waitFor</code> literally tells the dispatcher that it should wait before going on. For example a line such as <code>this.waitFor(NoteStore);</code> at <code>LaneStore</code> would force the <code>NoteStore</code> operation to proceed only after <code>NoteStore</code> has finished processing. Here&apos;s an example of how it would work:</p>
<pre><code class="lang-javascript">NoteActions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>task<span class="token punctuation">:</span> <span class="token string">&apos;New task&apos;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// triggers waitFor</span>
LaneActions<span class="token punctuation">.</span><span class="token function">attachToLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>waitFor</code> is a feature that should be used carefully. Always consider other alternatives before using it. In this particular case, there&apos;s no easy way around it.</p>
<p>To get started we should add <code>attachToLane</code> to actions as before:</p>
<p><strong>app/actions/LaneActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">generateActions</span><span class="token punctuation">(</span><span class="token string">&apos;create&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;attachToLane&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The next step takes more code. We need to take care of attaching:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> uuid from <span class="token string">&apos;node-uuid&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteStore from <span class="token string">&apos;./NoteStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LaneStore</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">attachToLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>noteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span>NoteStore<span class="token punctuation">)</span><span class="token punctuation">;</span>

      noteId <span class="token operator">=</span> NoteStore<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>notes<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> targetId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findLane</span><span class="token punctuation">(</span>laneId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>targetId <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> lane <span class="token operator">=</span> lanes<span class="token punctuation">[</span>targetId<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>lane<span class="token punctuation">.</span>notes<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>noteId<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lane<span class="token punctuation">.</span>notes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lanes<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&apos;Already attached note to lane&apos;</span><span class="token punctuation">,</span> lanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">findLane</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>LaneStore<span class="token punctuation">,</span> <span class="token string">&apos;LaneStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>attachToLane</code> has been coded defensively to guard against possible problems. Unless we pass <code>noteId</code>, we <code>waitFor</code> one. Passing one explicitly becomes useful when we implement drag and drop, so it&apos;s good to have it in place.</p>
<p>The rest of the code deals with the logic. First we try to find a matching lane. If found, we attach the note id to it unless it has been attached already.</p>
<h3 class="header"><a class="header-anchor" href="#setting-up-detachfromlane-" id="setting-up-detachfromlane-"></a><span class="text">Setting Up <code>detachFromLane</code></span><a class="header-anchor-select" href="#setting-up-detachfromlane-">#</a></h3>
<p><code>deleteNote</code> is the opposite operation of <code>addNote</code>. When removing a <code>Note</code>, it&apos;s important to remove its association with a <code>Lane</code> as well. For this purpose we can implement <code>LaneActions.detachFromLane({laneId: &lt;id&gt;})</code>. We would use it like this:</p>
<pre><code class="lang-javascript">LaneActions<span class="token punctuation">.</span><span class="token function">detachFromLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
NoteActions<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Again, we should set up an action:</p>
<p><strong>app/actions/LaneActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">generateActions</span><span class="token punctuation">(</span><span class="token string">&apos;create&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;attachToLane&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;detachFromLane&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The implementation will resemble <code>attachToLane</code>. In this case we&apos;ll remove the possibly found <code>Note</code> instead:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> uuid from <span class="token string">&apos;node-uuid&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteStore from <span class="token string">&apos;./NoteStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LaneStore</span> <span class="token punctuation">{</span>
  <span class="token function">attachToLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">}</span>
  <span class="token function">detachFromLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> targetId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findLane</span><span class="token punctuation">(</span>laneId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>targetId <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> lane <span class="token operator">=</span> lanes<span class="token punctuation">[</span>targetId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> notes <span class="token operator">=</span> lane<span class="token punctuation">.</span>notes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> removeIndex <span class="token operator">=</span> notes<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>removeIndex <span class="token operator">!</span><span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lane<span class="token punctuation">.</span>notes <span class="token operator">=</span> notes<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> removeIndex<span class="token punctuation">)</span><span class="token punctuation">.</span>
        <span class="token function">concat</span><span class="token punctuation">(</span>notes<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>removeIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lanes<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&apos;Failed to remove note from a lane as it didn\&apos;t exist&apos;</span><span class="token punctuation">,</span> lanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">findLane</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>LaneStore<span class="token punctuation">,</span> <span class="token string">&apos;LaneStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Again, the implementation has been coded with drag and drop in mind. Later on we&apos;ll want to pass <code>noteId</code> explicitly, so it doesn&apos;t hurt to have it there. You&apos;ve seen the rest of the code earlier in different contexts.</p>
<h3 class="header"><a class="header-anchor" href="#implementing-findlane-" id="implementing-findlane-"></a><span class="text">Implementing <code>findLane</code></span><a class="header-anchor-select" href="#implementing-findlane-">#</a></h3>
<p>Both <code>attachToLane</code> and <code>detachFromLane</code> depend on a helper method known as <code>findLane</code>. It will return a <code>Lane</code> index if found:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> uuid from <span class="token string">&apos;node-uuid&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteStore from <span class="token string">&apos;./NoteStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LaneStore</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">detachFromLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">}</span>
  <span class="token function">findLane</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> laneIndex <span class="token operator">=</span> lanes<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> lane<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>laneIndex <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&apos;Failed to find lane&apos;</span><span class="token punctuation">,</span> lanes<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> laneIndex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>LaneStore<span class="token punctuation">,</span> <span class="token string">&apos;LaneStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>findLane</code> has been coded defensively to warn if a <code>Lane</code> is not found. It relies on <code>findIndex</code> discussed earlier.</p>
<h3 class="header"><a class="header-anchor" href="#implementing-a-getter-for-notestore-" id="implementing-a-getter-for-notestore-"></a><span class="text">Implementing a Getter for <code>NoteStore</code></span><a class="header-anchor-select" href="#implementing-a-getter-for-notestore-">#</a></h3>
<p>Given our lanes contain references to notes through ids, we are going to need some way to resolve those ids to actual notes. One neat way to do this is to implement a public method <code>NoteStore.get(notes)</code> for the purpose. It accepts an array of <code>Note</code> ids, and returns corresponding objects.</p>
<p>This can be achieved using the <code>map</code> operation. First we need to get the ids of all notes to match against. After that, we can perform a lookup for each note id passed in using <code>indexOf</code>.</p>
<p>Just implementing the method isn&apos;t enough. We also need to make it public. In Alt this can be achieved using <code>this.exportPublicMethods</code>. It takes an object that describes the public interface of the store in question. Consider the implementation below:</p>
<p><strong>app/stores/NoteStore.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> uuid from <span class="token string">&apos;node-uuid&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NoteActions from <span class="token string">&apos;../actions/NoteActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">NoteStore</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bindActions</span><span class="token punctuation">(</span>NoteActions<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>notes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">exportPublicMethods</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span>ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ids<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>notes<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findNote</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>NoteStore<span class="token punctuation">,</span> <span class="token string">&apos;NoteStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Note that the implementation filters possible non-matching ids from the result.</p>
<h3 class="header"><a class="header-anchor" href="#connecting-lane-with-the-logic" id="connecting-lane-with-the-logic"></a><span class="text">Connecting <code>Lane</code> with the Logic</span><a class="header-anchor-select" href="#connecting-lane-with-the-logic">#</a></h3>
<p>Now that we have the logical bits together, we can integrate it with <code>Lane</code>. We&apos;ll need to take the newly added props (<code>id</code>, <code>notes</code>) into account, and glue this all together:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">import</span> LaneActions from <span class="token string">&apos;../actions/LaneActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lane</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> id <span class="token operator">=</span> props<span class="token punctuation">.</span>lane<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>addNote <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addNote<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>deleteNote <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>deleteNote<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>lane<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-header&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-name&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-add-note&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addNote<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>AltContainer
          stores<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>NoteStore<span class="token punctuation">]</span><span class="token punctuation">}</span>
          inject<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            items<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> NoteStore<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>lane<span class="token punctuation">.</span>notes<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Notes
            onEdit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>editNote<span class="token punctuation">}</span>
            onDelete<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>deleteNote<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>AltContainer<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addNote</span><span class="token punctuation">(</span>laneId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NoteActions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>task<span class="token punctuation">:</span> <span class="token string">&apos;New task&apos;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LaneActions<span class="token punctuation">.</span><span class="token function">attachToLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">editNote</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NoteActions<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">,</span> task<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">deleteNote</span><span class="token punctuation">(</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    LaneActions<span class="token punctuation">.</span><span class="token function">detachFromLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    NoteActions<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>There are two important changes:</p>
<ul>
<li><code>items: () =&gt; NoteStore.get(notes)</code> - Our new getter is used to filter <code>notes</code>.</li>
<li><code>addNote</code>, <code>deleteNote</code> - These operate now based on the new logic we specified. Note that we trigger <code>detachFromLane</code> before <code>delete</code> at <code>deleteNote</code>. Otherwise we may try to render non-existent notes. You can try swapping the order to see warnings.</li>
</ul>
<p>After these changes, we now have a system that can maintain relations between <code>Lanes</code> and <code>Notes</code>. The current structure allows us to keep singleton stores and a flat data structure. Dealing with references is a little awkward, but that&apos;s consistent with the Flux architecture.</p>
<p><img src="/images/kanban_02.png" alt="Separate notes"></p>
<h2 class="header"><a class="header-anchor" href="#implementing-edit-remove-for-lane-" id="implementing-edit-remove-for-lane-"></a><span class="text">Implementing Edit/Remove for <code>Lane</code></span><a class="header-anchor-select" href="#implementing-edit-remove-for-lane-">#</a></h2>
<p>We are still missing some basic functionality such as editing and removing lanes. We are going to reuse the functionality we used with <code>Note</code>, so let&apos;s rename it to <code>Editable.jsx</code> and tweak the code a bit to make it generic:</p>
<p><strong>app/components/Editable.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Editable</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment" spellcheck="true">// this.renderTask = this.renderTask.bind(this);</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>renderValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderValue<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      editing<span class="token punctuation">:</span> <span class="token keyword">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> onEdit<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
    <span class="token keyword">const</span> editing <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>editing<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>editing <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">renderEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
      autoFocus<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">true</span><span class="token punctuation">}</span>
      defaultValue<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value<span class="token punctuation">}</span>
      onBlur<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>finishEdit<span class="token punctuation">}</span>
      onKeyPress<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>checkEnter<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">renderValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// drop renderTask</span>
    <span class="token keyword">const</span> onDelete <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>onDelete<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>edit<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">&quot;value&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>onDelete <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>There are a couple of important changes:</p>
<ul>
<li><code>this.renderValue = this.renderValue.bind(this);</code> - Previously we had <code>Task</code>. Now we are using the term <code>Value</code> as that&apos;s more generic.</li>
<li><code>const {value, onEdit, ...props} = this.props;</code> - We changed task to value here as well.</li>
<li><code>renderValue()</code> - Formerly this was known as <code>renderTask()</code>. Again, an abstraction step. Note that we refer to <code>this.props.value</code> and not <code>this.props.task</code>.</li>
</ul>
<p>Because the class name changes, <code>main.css</code> needs a small tweak:</p>
<p><strong>app/main.css</strong></p>
<pre><code class="lang-css"><span class="token comment" spellcheck="true">/*.note .task {*/</span>
<span class="token selector">.note .value </span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/* force to use inline-block so that it gets minimum height */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 class="header"><a class="header-anchor" href="#pointing-notes-to-editable-" id="pointing-notes-to-editable-"></a><span class="text">Pointing <code>Notes</code> to <code>Editable</code></span><a class="header-anchor-select" href="#pointing-notes-to-editable-">#</a></h3>
<p>Next we need to make <code>Notes.jsx</code> point at the new component. We&apos;ll need to alter the import and the component name at <code>render()</code>:</p>
<p><strong>app/components/Notes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> React from <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Editable from <span class="token string">&apos;./Editable.jsx&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Notes</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">renderNote</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>li className<span class="token operator">=</span><span class="token string">&quot;note&quot;</span> key<span class="token operator">=</span><span class="token punctuation">{</span>note<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Editable
          value<span class="token operator">=</span><span class="token punctuation">{</span>note<span class="token punctuation">.</span>task<span class="token punctuation">}</span>
          onEdit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>onEdit<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span>
          onDelete<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>onDelete<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 class="header"><a class="header-anchor" href="#connecting-lane-with-editable-" id="connecting-lane-with-editable-"></a><span class="text">Connecting <code>Lane</code> with <code>Editable</code></span><a class="header-anchor-select" href="#connecting-lane-with-editable-">#</a></h3>
<p>Next we can use this generic component to allow a <code>Lane</code>&apos;s name to be modified. This will give a hook for our logic. We&apos;ll need to alter <code>&lt;div className=&apos;lane-name&apos;&gt;{name}&lt;/div&gt;</code> as follows:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">import</span> Editable from <span class="token string">&apos;./Editable.jsx&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lane</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>editName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>editName<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>lane<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-header&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Editable className<span class="token operator">=</span><span class="token string">&quot;lane-name&quot;</span> value<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>name<span class="token punctuation">}</span>
            onEdit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>editName<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lane-add-note&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addNote<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">editName</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;edited lane name&apos;</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If you try to edit a lane name now, you should see a log at the console.</p>
<p><img src="/images/kanban_03.png" alt="Logging lane name editing"></p>
<h3 class="header"><a class="header-anchor" href="#defining-editable-logic" id="defining-editable-logic"></a><span class="text">Defining <code>Editable</code> Logic</span><a class="header-anchor-select" href="#defining-editable-logic">#</a></h3>
<p>We will need to define some logic to make this work. To follow the same idea as with <code>Note</code>, we can model the remaining CRUD actions here. We&apos;ll need to set up <code>update</code> and <code>delete</code> actions in particular.</p>
<p><strong>app/actions/LaneActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> alt from <span class="token string">&apos;../libs/alt&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">generateActions</span><span class="token punctuation">(</span>
  <span class="token string">&apos;create&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;update&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;delete&apos;</span><span class="token punctuation">,</span>
  <span class="token string">&apos;attachToLane&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;detachFromLane&apos;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We are also going to need <code>LaneStore</code> level implementations for these. They can be modeled based on what we have seen in <code>NoteStore</code> earlier:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">LaneStore</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> targetId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findLane</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>targetId <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    lanes<span class="token punctuation">[</span>targetId<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lanes<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
    <span class="token keyword">const</span> targetId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findLane</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>targetId <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      lanes<span class="token punctuation">:</span> lanes<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> targetId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>lanes<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>targetId <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">attachToLane</span><span class="token punctuation">(</span><span class="token punctuation">{</span>laneId<span class="token punctuation">,</span> noteId<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> alt<span class="token punctuation">.</span><span class="token function">createStore</span><span class="token punctuation">(</span>LaneStore<span class="token punctuation">,</span> <span class="token string">&apos;LaneStore&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote class="warning">If a lane is deleted, it would be a good idea to get rid of the associated notes as well. In the current implementation they are left hanging in the <code>NoteStore</code>. It doesn&apos;t hurt the functionality but it&apos;s one of those details that you may want to be aware of.</blockquote><p>Now that we have resolved actions and store, we need to adjust our component to take these changes into account:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lane</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">editName</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      LaneActions<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      LaneActions<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Try modifying a lane name now. Modifications now should get saved the same way as they do for notes. Deleting lanes should be possible as well.</p>
<p><img src="/images/kanban_04.png" alt="Editing a lane name"></p>
<h2 class="header"><a class="header-anchor" href="#styling-kanban-board" id="styling-kanban-board"></a><span class="text">Styling Kanban Board</span><a class="header-anchor-select" href="#styling-kanban-board">#</a></h2>
<p>As we added <code>Lanes</code> to the application, the styling went a bit off. Add the following styling to make it a little nicer:</p>
<p><strong>app/main.css</strong></p>
<pre><code class="lang-css"><span class="token selector">body </span><span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> cornsilk<span class="token punctuation">;</span>

  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.lane </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>

  <span class="token property">margin</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>

  <span class="token property">background-color</span><span class="token punctuation">:</span> #efefef<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>

  <span class="token property">min-width</span><span class="token punctuation">:</span> 10em<span class="token punctuation">;</span>
  <span class="token property">vertical-align</span><span class="token punctuation">:</span> top<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.lane-header </span><span class="token punctuation">{</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>

  <span class="token property">padding</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>

  <span class="token property">color</span><span class="token punctuation">:</span> #efefef<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>

  <span class="token property">border-top-left-radius</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">border-top-right-radius</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.lane-name </span><span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.lane-add-note </span><span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>

  <span class="token property">margin-left</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.add-lane, .lane-add-note button </span><span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fdfdfd<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

...
</code></pre>
<p>You should end up with a result like this:</p>
<p><img src="/images/kanban_05.png" alt="Styled Kanban"></p>
<p>As this is a small project, we can leave the CSS in a single file like this. In case it starts growing, consider separating it to multiple files. One way to do this is to extract CSS per component and then refer to it there (e.g., <code>require(&apos;./lane.css&apos;)</code> at <code>Lane.jsx</code>).</p>
<p>Besides keeping things nice and tidy, Webpack&apos;s lazy loading machinery can pick this up. As a result, the initial CSS your user has to load will be smaller. I go into further detail later as I discuss styling.</p>
<h2 class="header"><a class="header-anchor" href="#on-namespacing-components" id="on-namespacing-components"></a><span class="text">On Namespacing Components</span><a class="header-anchor-select" href="#on-namespacing-components">#</a></h2>
<p>So far we&apos;ve been defining a component per file. That&apos;s not the only way. It may be handy to treat a file as a namespace and expose multiple components from it. React provides <a href="https://facebook.github.io/react/docs/jsx-in-depth.html#namespaced-components">namespaces components</a> just for this purpose. In this case we could apply namespacing to the concept of <code>Lane</code> or <code>Note</code>. This would add some flexibility to our system while keeping it simple to manage. By using namespacing we could do something like this:</p>
<p><strong>app/components/Lanes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Lanes</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>items<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;lanes&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>lanes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderLane<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">renderLane</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// new</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>Lane className<span class="token operator">=</span><span class="token string">&quot;lane&quot;</span> key<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Lane<span class="token punctuation">.</span>Header id<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>id<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>name<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Lane<span class="token punctuation">.</span>Notes id<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>id<span class="token punctuation">}</span> notes<span class="token operator">=</span><span class="token punctuation">{</span>lane<span class="token punctuation">.</span>notes<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Lane<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// old</span>
    <span class="token comment" spellcheck="true">// return &lt;Lane className=&quot;lane&quot; key={lane.id} lane={lane} /&gt;;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">Lane</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

Lane<span class="token punctuation">.</span>Header <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">LaneHeader</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
Lane<span class="token punctuation">.</span>Notes <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">LaneNotes</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Lane<span class="token punctuation">;</span>
</code></pre>
<p>Now we have pushed the control over <code>Lane</code> formatting to a higher level. In this case the change isn&apos;t worth it, but it can make sense in a more complex case.</p>
<p>You can use a similar approach for more generic components as well. Consider something like <code>Form</code>. You could easily have <code>Form.Label</code>, <code>Form.Input</code>, <code>Form.Textarea</code> and so on. Each would contain your custom formatting and logic as needed.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>The current design has been optimized with drag and drop operations in mind. Moving notes within a lane is a matter of swapping ids. Moving notes from one lane to another is again an operation over ids. This structure leads to some complexity as we need to track ids, but it will pay off in the next chapter.</p>
<p>There isn&apos;t always a clear cut way to model data and relations. In other scenarios, we could push the references elsewhere. For instance the note to lane relation could be inversed and pushed to <code>Note</code> level. We would still need to track their order within a lane somehow. We would be pushing the complexity elsewhere by doing this.</p>
<p>Currently <code>NoteStore</code> is treated as a singleton. Another way to deal with it would be to create <code>NoteStore</code> per <code>Notes</code> dynamically. Even though this simplifies dealing with the relations somewhat, this is a Flux anti-pattern better avoided.</p>
<p>We still cannot move notes between lanes or within a lane. We will solve that in the next chapter as we implement drag and drop.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this chapter consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"><div class="mc-field-group"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div><div style="position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""></div><div class="clear"><input type="submit" class="btn button" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/images/delorean.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack_react/react_and_flux">React and Flux</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/images/dnd.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack_react/implementing_dnd">Implementing Drag and Drop</a></div></div><div id="disqus_thread"></div></div><a class="next-page" href="/webpack_react/implementing_dnd" title="Implementing Drag and Drop"></a><a class="previous-page" href="/webpack_react/react_and_flux" title="React and Flux"></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div></main><footer><div class="footer-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank">Mailing List</a></li><li><a href="https://gitter.im/survivejs/webpack_react" target="_blank">Gitter Chat</a></li><li><a href="https://github.com/survivejs/webpack_react" target="_blank">GitHub</a></li><li><a href="/atom.xml" target="_blank">Blog RSS</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/react-router5">react-router5 - Routing Alternative for React - Interview with Thomas Roch</a></li><li><a class="blog-teaser" href="/blog/survivejs-195">SurviveJS - Webpack and React v1.9.5</a></li><li><a class="blog-teaser" href="/blog/baobab-interview">Baobab - Data Trees with Cursors - Interview with Guillaume Plique</a></li><li><a class="blog-teaser" href="/blog/react-component-boilerplate-10">React Component Boilerplate v1.0</a></li><li><a class="blog-teaser" href="/blog/react-bootstrap-interview">React-Bootstrap - Bootstrap Rebuilt for React - Interview with Matt Smith</a></li><li><a class="blog-teaser" href="/blog/survivejs-19">SurviveJS - Webpack and React v1.9.0</a></li><li><a class="blog-teaser" href="/blog/cerebral-interview">Cerebral - Expressing Application Flow with Signals - Interview with Christian Alfoni</a></li><li><a class="blog-teaser" href="/blog/shaderfrog-interview">ShaderFrog - Building a WebGL Shader Editor and Composer - Interview with Andrew Ray</a></li><li><a class="blog-teaser" href="/blog/cycle-interview">Cycle.js - Reactive Framework for HCI - Interview with AndrÃ© Staltz</a></li><li><a class="blog-teaser" href="/blog/redux-interview">Redux - Reinventing Flux - Interview with Dan Abramov</a></li></ul></div><div class="footer-contact"><h3>Contact</h3><form action="//formspree.io/info@survivejs.com" method="POST"><label><span>Name:</span><input type="text" name="name"></label><label><span>Email:</span><input type="email" name="_replyto"></label><label><span>Message:</span><textarea name="message" rows="8">
</textarea></label><input type="hidden" name="_subject" value="SurviveJS"><input type="hidden" name="_next" value="//survivejs.com/thanks"><input type="text" name="_gotcha" style="display:none;"><label class="submit-container"><input type="submit" value="Send"></label></form></div></div></footer></div></body></html>