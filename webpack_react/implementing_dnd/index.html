<html lang="en"><head><title>SurviveJS - Implementing Drag and Drop</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui"/><meta name="description" content="
Our Kanban application is almost usable now. It looks alright and there&#x27;s some basic functionality in place. In this chapter, I&#x27;ll show you how to take it to the next level. We will integrate some drag and drop functionality as we set up React DnD. After this chapter, you should be able to sort notâ€¦"/><meta name="keywords" content="webpack,react,javascript,programming,web development"/><link rel="icon" type="image/png" href="/assets/img/favicon.png"/><link rel="alternate" type="application/atom+xml" href="./atom.xml"/><link rel="stylesheet" href="/assets/main.css"/></head><body><main role="main"><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/images/dnd.jpg);"></div><h1 class="post__heading">Implementing Drag and Drop</h1><div class="header-extra"><a href="https://www.flickr.com/photos/15146367@N00/4083260446">Emma Story (CC BY-NC)</a></div><div class="toc-nav__wrapper"><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li><a href="/webpack_react/introduction" class="toc-nav__link chapter">Introduction</a></li><li><a href="/webpack_react/webpack" class="toc-nav__link part">Setting Up Webpack</a></li><li><a href="/webpack_react/webpack_compared" class="toc-nav__link chapter">Webpack Compared</a></li><li><a href="/webpack_react/developing_with_webpack" class="toc-nav__link chapter">Developing with Webpack</a></li><li><a href="/webpack_react/webpack_and_react" class="toc-nav__link chapter">Webpack and React</a></li><li><a href="/webpack_react/react" class="toc-nav__link part">Developing a Kanban Application</a></li><li><a href="/webpack_react/implementing_notes" class="toc-nav__link chapter">Implementing a Basic Note Application</a></li><li><a href="/webpack_react/react_and_flux" class="toc-nav__link chapter">React and Flux</a></li><li><a href="/webpack_react/from_notes_to_kanban" class="toc-nav__link chapter">From Notes to Kanban</a></li><li><span class="toc-nav__link toc-nav__link--current chapter">Implementing Drag and Drop</span></li><li><a href="/webpack_react/building_kanban" class="toc-nav__link chapter">Building Kanban</a></li><li><a href="/webpack_react/advanced" class="toc-nav__link part">Advanced Techniques</a></li><li><a href="/webpack_react/testing_react" class="toc-nav__link chapter">Testing React*</a></li><li><a href="/webpack_react/typing_with_react" class="toc-nav__link chapter">Typing with React*</a></li><li><a href="/webpack_react/linting_in_webpack" class="toc-nav__link chapter">Linting in Webpack</a></li><li><a href="/webpack_react/authoring_libraries" class="toc-nav__link chapter">Authoring Packages</a></li><li><a href="/webpack_react/styling_react" class="toc-nav__link chapter">Styling React</a></li><li><a href="/webpack_react/appendices" class="toc-nav__link part">Appendices</a></li><li><a href="/webpack_react/structuring_react_projects" class="toc-nav__link chapter">Structuring React Projects</a></li><li><a href="/webpack_react/language_features" class="toc-nav__link chapter">Language Features</a></li><li><a href="/webpack_react/understanding_decorators" class="toc-nav__link chapter">Understanding Decorators</a></li><li><a href="/webpack_react/troubleshooting" class="toc-nav__link chapter">Troubleshooting</a></li></ul></div><div class="chapter"><div class="post__content"><blockquote class="latestpost tip"><div>From the blog:</div><a class="latestpost-link" href="/blog/survivejs200">SurviveJS - Webpack and React - v2.0.0</a></blockquote><div class="post__meta"><a class="post__end_source" href="https://github.com/survivejs/webpack_react/tree/master/project_source/07_implementing_dnd/kanban_app" target="_blank">Finished source code</a><a class="post__demo" href="/demos/07_implementing_dnd" target="_blank">Demo</a></div><div class="chapter-content"><p>Our Kanban application is almost usable now. It looks alright and there&#39;s some basic functionality in place. In this chapter, I&#39;ll show you how to take it to the next level. We will integrate some drag and drop functionality as we set up <a href="https://gaearon.github.io/react-dnd/">React DnD</a>. After this chapter, you should be able to sort notes within a lane and drag them from one lane to another.</p>
<h2 class="header"><a class="header-anchor" href="#setting-up-react-dnd" id="setting-up-react-dnd"></a><span class="text">Setting Up React DnD</span><a class="header-anchor-select" href="#setting-up-react-dnd">#</a></h2>
<p>As a first step, we&#39;ll need to connect React DnD with our project. We are going to use the HTML5 Drag and Drop based back-end. There are specific back-ends for testing and <a href="https://github.com/yahoo/react-dnd-touch-backend">touch</a>. In order to set it up, we need to use the <code>DragDropContext</code> decorator and provide the back-end to it:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span>DragDropContext<span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-dnd'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> HTML5Backend <span class="token keyword" >from</span> <span class="token string" >'react-dnd-html5-backend'</span><span class="token punctuation" >;</span>
</div>

<div class="leanpub-insert">
@<span class="token function" >DragDropContext</span><span class="token punctuation" >(</span>HTML5Backend<span class="token punctuation" >)</span>
</div>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>After this change, the application should look exactly the same as before. We are now ready to add some sweet functionality to it.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>If you aren&#39;t using <em>npm-install-webpack-plugin</em>, remember to install <em>react-dnd</em> and associated utilities to your project through <code>npm i react-dnd react-dnd-html5-backend react-addons-update -S</code>.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>Decorators provide us simple means to annotate our components. Alternatively we could use syntax, such as <code>DragDropContext(HTML5Backend)(App)</code>, but this would get rather unwieldy when we want to apply multiple decorators. See the decorator appendix to understand in detail how they work and how to implement them yourself.</blockquote><h2 class="header"><a class="header-anchor" href="#preparing-notes-to-be-sorted" id="preparing-notes-to-be-sorted"></a><span class="text">Preparing Notes to Be Sorted</span><a class="header-anchor-select" href="#preparing-notes-to-be-sorted">#</a></h2>
<p>Next, we will need to tell React DnD what can be dragged and where. Since we want to move notes, we&#39;ll need to annotate them accordingly. In addition, we&#39;ll need some logic to tell what happens during this process.</p>
<p>Earlier, we extracted editing functionality from <code>Note</code> and ended up dropping <code>Note</code>. It seems like we&#39;ll want to add that concept back to allow drag and drop.</p>
<p>We can use a handy little technique here that allows us to avoid code duplication. We can implement <code>Note</code> as a wrapper component. It will accept <code>Editable</code> and render it. This will allow us to keep DnD related logic in <code>Note</code>. This avoids having to duplicate any logic related to <code>Editable</code>.</p>
<p>The magic lies in a React property known as <code>children</code>. React will render possible child components in the slot <code>{this.props.children}</code>. Set up <em>Note.jsx</em> as shown below:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>We also need to tweak <code>Notes</code> to use our wrapper component. We will simply wrap <code>Editable</code> using <code>Note</code>, and we are good to go. We will pass <code>note</code> data to the wrapper as we&#39;ll need that later when dealing with logic:</p>
<p><strong>app/components/Notes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Editable <span class="token keyword" >from</span> <span class="token string" >'./Editable.jsx'</span><span class="token punctuation" >;</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> Note <span class="token keyword" >from</span> <span class="token string" >'./Note.jsx'</span><span class="token punctuation" >;</span>
</div>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >,</span> onValueClick<span class="token punctuation" >,</span> onEdit<span class="token punctuation" >,</span> onDelete<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
    <span class="token operator" >&lt;</span>ul className<span class="token operator" >=</span><span class="token string" >"notes"</span><span class="token operator" >></span><span class="token punctuation" >{</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span>
<div class="leanpub-delete">
      <span class="token operator" >&lt;</span>li className<span class="token operator" >=</span><span class="token string" >"note"</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span><span class="token operator" >></span>
        <span class="token operator" >&lt;</span>Editable
          editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span>
          value<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>task<span class="token punctuation" >}</span>
          onValueClick<span class="token operator" >=</span><span class="token punctuation" >{</span>onValueClick<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span>onEdit<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span>onDelete<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span> <span class="token operator" >/</span><span class="token operator" >></span>
      <span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
</div>
<div class="leanpub-insert">
      <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span><span class="token operator" >></span>
        <span class="token operator" >&lt;</span>Editable
          editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span>
          value<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>task<span class="token punctuation" >}</span>
          onValueClick<span class="token operator" >=</span><span class="token punctuation" >{</span>onValueClick<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span>onEdit<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span>onDelete<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span> <span class="token operator" >/</span><span class="token operator" >></span>
      <span class="token operator" >&lt;</span><span class="token operator" >/</span>Note<span class="token operator" >></span>
</div>
    <span class="token punctuation" >)</span><span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>ul<span class="token operator" >></span>
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>After this change, the application should look exactly the same as before. We have achieved nothing yet. Fortunately, we can start adding functionality, now that we have the foundation in place.</p>
<h2 class="header"><a class="header-anchor" href="#allowing-notes-to-be-dragged" id="allowing-notes-to-be-dragged"></a><span class="text">Allowing Notes to Be Dragged</span><a class="header-anchor-select" href="#allowing-notes-to-be-dragged">#</a></h2>
<p>React DnD uses constants to tell different draggables apart. Set up a file for tracking <code>Note</code> as follows:</p>
<p><strong>app/constants/itemTypes.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >{</span>
  NOTE<span class="token punctuation" >:</span> <span class="token string" >'note'</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>This definition can be expanded later as we add new types to the system.</p>
<p>Next, we need to tell our <code>Note</code> that it&#39;s possible to drag and drop it. This is done through <code>@DragSource</code> and <code>@DropTarget</code> annotations.</p>
<h3 class="header"><a class="header-anchor" href="#setting-up-note-dragsource-" id="setting-up-note-dragsource-"></a><span class="text">Setting Up <code>Note</code> <code>@DragSource</code></span><a class="header-anchor-select" href="#setting-up-note-dragsource-">#</a></h3>
<p>Marking a component as a <code>@DragSource</code> simply means that it can be dragged. Set up the annotation like this:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span>DragSource<span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-dnd'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> ItemTypes <span class="token keyword" >from</span> <span class="token string" >'../constants/itemTypes'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> noteSource <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'begin dragging note'</span><span class="token punctuation" >,</span> props<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>

<div class="leanpub-delete">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
@<span class="token function" >DragSource</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteSource<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDragSource<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> id<span class="token punctuation" >,</span> onMove<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</div>
</code></pre>
<p>There are a couple of important changes:</p>
<ul>
<li>We set up imports for the new logic.</li>
<li>We defined a <code>noteSource</code>. It contains a <code>beginDrag</code> handler. We can set the initial state for dragging here. For now we just have a debug log there.</li>
<li><code>@DragSource</code> connects <code>NOTE</code> item type with <code>noteSource</code>.</li>
<li><code>id</code> and <code>onMove</code> props are extracted from <code>this.props</code>. We&#39;ll use these later on to set up a callback so that the parent of a <code>Note</code> can deal with the moving related logic.</li>
<li>Finally <code>connectDragSource</code> prop wraps the element at <code>render()</code>. It could be applied to a specific part of it. This would be handy for implementing handles for example.</li>
</ul>
<p>If you drag a <code>Note</code> now, you should see a debug message at the console.</p>
<p>We still need to make sure <code>Note</code> works as a <code>@DropTarget</code>. Later on this will allow swapping them as we add logic in place.</p>
<blockquote class="warning"><i class="icon-attention"></i>Note that React DnD doesn&#39;t support hot loading perfectly. You may need to refresh the browser to see the log messages you expect!</blockquote><h3 class="header"><a class="header-anchor" href="#setting-up-note-droptarget-" id="setting-up-note-droptarget-"></a><span class="text">Setting Up <code>Note</code> <code>@DropTarget</code></span><a class="header-anchor-select" href="#setting-up-note-droptarget-">#</a></h3>
<p><code>@DropTarget</code> allows a component to receive components annotated with <code>@DragSource</code>. As <code>@DropTarget</code> triggers, we can perform actual logic based on the components. Expand as follows:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<div class="leanpub-delete">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span>DragSource<span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-dnd'</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span>DragSource<span class="token punctuation" >,</span> DropTarget<span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-dnd'</span><span class="token punctuation" >;</span>
</div>
<span class="token keyword" >import</span> ItemTypes <span class="token keyword" >from</span> <span class="token string" >'../constants/itemTypes'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> noteSource <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'begin dragging note'</span><span class="token punctuation" >,</span> props<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<div class="leanpub-insert">
<span class="token keyword" >const</span> noteTarget <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'dragging note'</span><span class="token punctuation" >,</span> sourceProps<span class="token punctuation" >,</span> targetProps<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>

@<span class="token function" >DragSource</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteSource<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDragSource<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
<div class="leanpub-insert">
@<span class="token function" >DropTarget</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteTarget<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDropTarget<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dropTarget</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
</div>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> id<span class="token punctuation" >,</span> onMove<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> connectDropTarget<span class="token punctuation" >,</span>
      id<span class="token punctuation" >,</span> onMove<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span><span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>
</code></pre>
<p>Refresh the browser and try to drag a note around. You should see a lot of log messages.</p>
<p>Both decorators give us access to the <code>Note</code> props. In this case, we are using <code>monitor.getItem()</code> to access them at <code>noteTarget</code>. This is the key to making this to work properly.</p>
<h2 class="header"><a class="header-anchor" href="#developing-onmove-api-for-notes-" id="developing-onmove-api-for-notes-"></a><span class="text">Developing <code>onMove</code> API for <code>Notes</code></span><a class="header-anchor-select" href="#developing-onmove-api-for-notes-">#</a></h2>
<p>Now, that we can move notes around, we still need to define logic. The following steps are needed:</p>
<ol>
<li>Capture <code>Note</code> id on <code>beginDrag</code>.</li>
<li>Capture target <code>Note</code> id on <code>hover</code>.</li>
<li>Trigger <code>onMove</code> callback on <code>hover</code> so that we can deal with the logic at a higher level.</li>
</ol>
<p>You can see how this translates to code below:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >const</span> noteSource <span class="token operator" >=</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'begin dragging note'</span><span class="token punctuation" >,</span> props<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
      id<span class="token punctuation" >:</span> props<span class="token punctuation" >.</span>id
    <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> noteTarget <span class="token operator" >=</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'dragging note'</span><span class="token punctuation" >,</span> sourceProps<span class="token punctuation" >,</span> targetProps<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> targetId <span class="token operator" >=</span> targetProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    <span class="token keyword" >if</span><span class="token punctuation" >(</span>sourceId <span class="token operator" >!==</span> targetId<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      targetProps<span class="token punctuation" >.</span><span class="token function" >onMove</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>If you run the application now, you&#39;ll likely get a bunch of <code>onMove</code> related errors. We should make <code>Notes</code> aware of it:</p>
<p><strong>app/components/Notes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Editable <span class="token keyword" >from</span> <span class="token string" >'./Editable.jsx'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Note <span class="token keyword" >from</span> <span class="token string" >'./Note.jsx'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >,</span> onValueClick<span class="token punctuation" >,</span> onEdit<span class="token punctuation" >,</span> onDelete<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
    <span class="token operator" >&lt;</span>ul className<span class="token operator" >=</span><span class="token string" >"notes"</span><span class="token operator" >></span><span class="token punctuation" >{</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
      <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
<div class="leanpub-delete">
        <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
<div class="leanpub-insert">
        <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span>
          onMove<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span>
            console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span>
        <span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
          <span class="token operator" >&lt;</span>Editable
            editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span>
            value<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>task<span class="token punctuation" >}</span>
            onValueClick<span class="token operator" >=</span><span class="token punctuation" >{</span>onValueClick<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
            onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span>onEdit<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
            onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span>onDelete<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span> <span class="token operator" >/</span><span class="token operator" >></span>
        <span class="token operator" >&lt;</span><span class="token operator" >/</span>Note<span class="token operator" >></span>
      <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >}</span>
    <span class="token operator" >&lt;</span><span class="token operator" >/</span>ul<span class="token operator" >></span>
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>If you drag a <code>Note</code> around now, you should see log messages like <code>source &lt;id&gt; target &lt;id&gt;</code> in the console. We are getting close. We still need to figure out what to do with these ids, though.</p>
<h2 class="header"><a class="header-anchor" href="#adding-action-and-store-method-for-moving" id="adding-action-and-store-method-for-moving"></a><span class="text">Adding Action and Store Method for Moving</span><a class="header-anchor-select" href="#adding-action-and-store-method-for-moving">#</a></h2>
<p>The logic of drag and drop goes as follows. Suppose we have a lane containing notes A, B, C. In case we move A below C we should end up with B, C, A. In case we have another list, say D, E, F, and move A to the beginning of it, we should end up with B, C and A, D, E, F.</p>
<p>In our case, we&#39;ll get some extra complexity due to lane to lane dragging. When we move a <code>Note</code>, we know its original position and the intended target position. <code>Lane</code> knows what <code>Notes</code> belong to it by id. We are going to need some way to tell <code>LaneStore</code> that it should perform the logic over given notes. A good starting point is to define <code>LaneActions.move</code>:</p>
<p><strong>app/actions/LaneActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> alt <span class="token keyword" >from</span> <span class="token string" >'../libs/alt'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt<span class="token punctuation" >.</span><span class="token function" >generateActions</span><span class="token punctuation" >(</span>
  <span class="token string" >'create'</span><span class="token punctuation" >,</span> <span class="token string" >'update'</span><span class="token punctuation" >,</span> <span class="token string" >'delete'</span><span class="token punctuation" >,</span>
  <span class="token string" >'attachToLane'</span><span class="token punctuation" >,</span> <span class="token string" >'detachFromLane'</span><span class="token punctuation" >,</span>
  <span class="token string" >'move'</span>
<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>We should connect this action with the <code>onMove</code> hook we just defined:</p>
<p><strong>app/components/Notes.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Editable <span class="token keyword" >from</span> <span class="token string" >'./Editable.jsx'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Note <span class="token keyword" >from</span> <span class="token string" >'./Note.jsx'</span><span class="token punctuation" >;</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> LaneActions <span class="token keyword" >from</span> <span class="token string" >'../actions/LaneActions'</span><span class="token punctuation" >;</span>
</div>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >,</span> onValueClick<span class="token punctuation" >,</span> onEdit<span class="token punctuation" >,</span> onDelete<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
    <span class="token operator" >&lt;</span>ul className<span class="token operator" >=</span><span class="token string" >"notes"</span><span class="token operator" >></span><span class="token punctuation" >{</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
      <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
<div class="leanpub-delete">
        <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span>
          onMove<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span>
            console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span>
        <span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
<div class="leanpub-insert">
        <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span>
          onMove<span class="token operator" >=</span><span class="token punctuation" >{</span>LaneActions<span class="token punctuation" >.</span>move<span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
          <span class="token operator" >&lt;</span>Editable
            editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span>
            value<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>task<span class="token punctuation" >}</span>
            onValueClick<span class="token operator" >=</span><span class="token punctuation" >{</span>onValueClick<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
            onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span>onEdit<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
            onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span>onDelete<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span> <span class="token operator" >/</span><span class="token operator" >></span>
        <span class="token operator" >&lt;</span><span class="token operator" >/</span>Note<span class="token operator" >></span>
      <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >}</span>
    <span class="token operator" >&lt;</span><span class="token operator" >/</span>ul<span class="token operator" >></span>
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>It could be a good idea to refactor <code>onMove</code> as a prop to make the system more flexible. In our implementation the <code>Notes</code> component is coupled with <code>LaneActions</code>. This isn&#39;t particularly nice if you want to use it in some other context.</blockquote><p>We should also define a stub at <code>LaneStore</code> to see that we wired it up correctly:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >LaneStore</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token function" >detachFromLane</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>laneId<span class="token punctuation" >,</span> noteId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token punctuation" >}</span>
<div class="leanpub-insert">
  <span class="token function" >move</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt<span class="token punctuation" >.</span><span class="token function" >createStore</span><span class="token punctuation" >(</span>LaneStore<span class="token punctuation" >,</span> <span class="token string" >'LaneStore'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>You should see the same log messages as earlier. Next, we&#39;ll need to add some logic to make this work. We can use the logic outlined above here. We have two cases to worry about: moving within a lane itself and moving from lane to another.</p>
<h2 class="header"><a class="header-anchor" href="#implementing-note-drag-and-drop-logic" id="implementing-note-drag-and-drop-logic"></a><span class="text">Implementing Note Drag and Drop Logic</span><a class="header-anchor-select" href="#implementing-note-drag-and-drop-logic">#</a></h2>
<p>Moving within a lane itself is complicated. When you are operating based on ids and perform operations one at a time, you&#39;ll need to take possible index alterations into account. As a result, I&#39;m using <code>update</code> <a href="https://facebook.github.io/react/docs/update.html">immutability helper</a> from React as that solves the problem in one pass.</p>
<p>It is possible to solve the lane to lane case using <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/splice">splice</a>. First, we <code>splice</code> out the source note, and then we <code>splice</code> it to the target lane. Again, <code>update</code> could work here, but I didn&#39;t see much point in that given <code>splice</code> is nice and simple. The code below illustrates a mutation based solution:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> update <span class="token keyword" >from</span> <span class="token string" >'react-addons-update'</span><span class="token punctuation" >;</span>
</div>

<span class="token keyword" >class</span> <span class="token class-name" >LaneStore</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-delete">
  <span class="token function" >move</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >move</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>sourceId<span class="token punctuation" >,</span> targetId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> lanes <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>lanes<span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceLane <span class="token operator" >=</span> lanes<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation" >(</span>lane <span class="token operator" >=</span><span class="token operator" >></span> lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation" >(</span>sourceId<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >[</span><span class="token number" >0</span><span class="token punctuation" >]</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> targetLane <span class="token operator" >=</span> lanes<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation" >(</span>lane <span class="token operator" >=</span><span class="token operator" >></span> lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation" >(</span>targetId<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >[</span><span class="token number" >0</span><span class="token punctuation" >]</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceNoteIndex <span class="token operator" >=</span> sourceLane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >indexOf</span><span class="token punctuation" >(</span>sourceId<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> targetNoteIndex <span class="token operator" >=</span> targetLane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >indexOf</span><span class="token punctuation" >(</span>targetId<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >if</span><span class="token punctuation" >(</span>sourceLane <span class="token operator" >===</span> targetLane<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      <span class="token comment" spellcheck="true">// move at once to avoid complications</span>
      sourceLane<span class="token punctuation" >.</span>notes <span class="token operator" >=</span> <span class="token function" >update</span><span class="token punctuation" >(</span>sourceLane<span class="token punctuation" >.</span>notes<span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
        $splice<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
          <span class="token punctuation" >[</span>sourceNoteIndex<span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
          <span class="token punctuation" >[</span>targetNoteIndex<span class="token punctuation" >,</span> <span class="token number" >0</span><span class="token punctuation" >,</span> sourceId<span class="token punctuation" >]</span>
        <span class="token punctuation" >]</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
    <span class="token keyword" >else</span> <span class="token punctuation" >{</span>
      <span class="token comment" spellcheck="true">// get rid of the source</span>
      sourceLane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >splice</span><span class="token punctuation" >(</span>sourceNoteIndex<span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

      <span class="token comment" spellcheck="true">// and move it to target</span>
      targetLane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >splice</span><span class="token punctuation" >(</span>targetNoteIndex<span class="token punctuation" >,</span> <span class="token number" >0</span><span class="token punctuation" >,</span> sourceId<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>

    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>lanes<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt<span class="token punctuation" >.</span><span class="token function" >createStore</span><span class="token punctuation" >(</span>LaneStore<span class="token punctuation" >,</span> <span class="token string" >'LaneStore'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>If you try out the application now, you can actually drag notes around and it should behave as you expect. Dragging to empty lanes doesn&#39;t work, though, and the presentation could be better.</p>
<p>It would be better if we indicated the dragged note&#39;s location more clearly. We can do this by hiding the dragged note from the list. React DnD provides us the hooks we need for this purpose.</p>
<h3 class="header"><a class="header-anchor" href="#indicating-where-to-move" id="indicating-where-to-move"></a><span class="text">Indicating Where to Move</span><a class="header-anchor-select" href="#indicating-where-to-move">#</a></h3>
<p>React DnD provides a feature known as state monitors. Through it we can use <code>monitor.isDragging()</code> to detect which <code>Note</code> we are currently dragging. It can be set up as follows:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<div class="leanpub-delete">
@<span class="token function" >DragSource</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteSource<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDragSource<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
</div>
<div class="leanpub-insert">
@<span class="token function" >DragSource</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteSource<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDragSource<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  isDragging<span class="token punctuation" >:</span> monitor<span class="token punctuation" >.</span><span class="token function" >isDragging</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token comment" spellcheck="true">// map isDragging() state to isDragging prop</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
</div>
@<span class="token function" >DropTarget</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteTarget<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDropTarget<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dropTarget</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> connectDropTarget<span class="token punctuation" >,</span>
      id<span class="token punctuation" >,</span> onMove<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span><span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>li <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> connectDropTarget<span class="token punctuation" >,</span> isDragging<span class="token punctuation" >,</span>
      onMove<span class="token punctuation" >,</span> id<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>

    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span><span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>li style<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token punctuation" >{</span>
        opacity<span class="token punctuation" >:</span> isDragging <span class="token operator" >?</span> <span class="token number" >0</span> <span class="token punctuation" >:</span> <span class="token number" >1</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >}</span> <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>
</code></pre>
<p>If you drag a note within a lane, the dragged note should be shown as blank. If you try moving the note to another lane and move it there, you will see this doesn&#39;t quite work, though.</p>
<p>The problem is that our note component gets unmounted during this process. This makes it lose <code>isDragging</code> state. Fortunately, we can override the default behavior by implementing a <code>isDragging</code> check of our own to fix the issue. Perform the following addition:</p>
<p><strong>app/components/Note.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<div class="leanpub-delete">
<span class="token keyword" >const</span> noteSource <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
      id<span class="token punctuation" >:</span> props<span class="token punctuation" >.</span>id
    <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >const</span> noteSource <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >beginDrag</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
      id<span class="token punctuation" >:</span> props<span class="token punctuation" >.</span>id
    <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token function" >isDragging</span><span class="token punctuation" >(</span>props<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> props<span class="token punctuation" >.</span>id <span class="token operator" >===</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>This tells React DnD to perform our custom check instead of relying on the default logic. After this change, unmounting won&#39;t be an issue and the feature works as we expect.</p>
<p>There is one little problem in our system. We cannot drag notes to an empty lane yet.</p>
<h2 class="header"><a class="header-anchor" href="#dragging-notes-to-empty-lanes" id="dragging-notes-to-empty-lanes"></a><span class="text">Dragging Notes to Empty Lanes</span><a class="header-anchor-select" href="#dragging-notes-to-empty-lanes">#</a></h2>
<p>To drag notes to empty lanes, we should allow them to receive notes. Just as above, we can set up <code>DropTarget</code> based logic for this. First, we need to capture the drag on <code>Lane</code>:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span>DropTarget<span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-dnd'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> ItemTypes <span class="token keyword" >from</span> <span class="token string" >'../constants/itemTypes'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> noteTarget <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> targetId <span class="token operator" >=</span> targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

@<span class="token function" >DropTarget</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteTarget<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDropTarget<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dropTarget</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
</div>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Lane</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>lane<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDropTarget<span class="token punctuation" >,</span> lane<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>
</div>

<div class="leanpub-delete">
    <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >return</span> <span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
</div>
      <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>If you refresh your browser and drag a note to a lane now, you should see log messages at your console. The question is what to do with this data? Before actually moving the note to a lane, we should check whether it&#39;s empty or not. If it has content already, the operation doesn&#39;t make sense. Our existing logic can deal with that.</p>
<p>This is a simple check to make. Given we know the target lane at our <code>noteTarget</code> <code>hover</code> handler, we can check its <code>notes</code> array as follows:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >const</span> noteTarget <span class="token operator" >=</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> targetId <span class="token operator" >=</span> targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token template-string" ><span class="token string" >`source: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>sourceId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >, target: </span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>targetId<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >`</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token operator" >!</span>targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span>length<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'source'</span><span class="token punctuation" >,</span> sourceId<span class="token punctuation" >,</span> <span class="token string" >'target'</span><span class="token punctuation" >,</span> targetProps<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>If you refresh your browser and drag around now, the log message should appear only when you drag a note to a lane that doesn&#39;t have any notes attached to it yet.</p>
<h3 class="header"><a class="header-anchor" href="#triggering-move-logic" id="triggering-move-logic"></a><span class="text">Triggering <code>move</code> Logic</span><a class="header-anchor-select" href="#triggering-move-logic">#</a></h3>
<p>Now we know what <code>Note</code> to move into which <code>Lane</code>. <code>LaneStore.attachToLane</code> is ideal for this purpose. Adjust <code>Lane</code> as follows:</p>
<p><strong>app/components/Lane.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >const</span> noteTarget <span class="token operator" >=</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token operator" >!</span>targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span>length<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'source'</span><span class="token punctuation" >,</span> sourceId<span class="token punctuation" >,</span> <span class="token string" >'target'</span><span class="token punctuation" >,</span> targetProps<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
  <span class="token function" >hover</span><span class="token punctuation" >(</span>targetProps<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> sourceProps <span class="token operator" >=</span> monitor<span class="token punctuation" >.</span><span class="token function" >getItem</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token keyword" >const</span> sourceId <span class="token operator" >=</span> sourceProps<span class="token punctuation" >.</span>id<span class="token punctuation" >;</span>

    <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token operator" >!</span>targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span>length<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      LaneActions<span class="token punctuation" >.</span><span class="token function" >attachToLane</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
        laneId<span class="token punctuation" >:</span> targetProps<span class="token punctuation" >.</span>lane<span class="token punctuation" >.</span>id<span class="token punctuation" >,</span>
        noteId<span class="token punctuation" >:</span> sourceId
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>There is one problem, though. What happens to the old instance of the <code>Note</code>? In the current solution, the old lane will have an id pointing to it. As a result, we will have duplicate data in the system.</p>
<p>Earlier, we resolved this using <code>detachFromLane</code>. The problem is that we don&#39;t know to which lane the note belonged. We could pass this data through the component hierarchy, but that doesn&#39;t feel particularly nice.</p>
<p>We can resolve this by adding a check against the case at <code>attachToLane</code>:</p>
<p><strong>app/stores/LaneStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >LaneStore</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token function" >attachToLane</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>laneId<span class="token punctuation" >,</span> noteId<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> lanes <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>lanes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>lane <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-insert">
      <span class="token keyword" >if</span><span class="token punctuation" >(</span>lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation" >(</span>noteId<span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        lane<span class="token punctuation" >.</span>notes <span class="token operator" >=</span> lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> note <span class="token operator" >!==</span> noteId<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span>
</div>

      <span class="token keyword" >if</span><span class="token punctuation" >(</span>lane<span class="token punctuation" >.</span>id <span class="token operator" >===</span> laneId<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >if</span><span class="token punctuation" >(</span>lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation" >(</span>noteId<span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
          console<span class="token punctuation" >.</span><span class="token function" >warn</span><span class="token punctuation" >(</span><span class="token string" >'Already attached note to lane'</span><span class="token punctuation" >,</span> lanes<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
        <span class="token punctuation" >}</span>
        <span class="token keyword" >else</span> <span class="token punctuation" >{</span>
          lane<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >push</span><span class="token punctuation" >(</span>noteId<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
        <span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span>

      <span class="token keyword" >return</span> lane<span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>lanes<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>
</code></pre>
<p><code>removeNote(noteId)</code> goes through <code>LaneStore</code> data. If it finds a note by id, it will get rid of it. After that, we have a clean slate, and we can add a note to a lane. This change allows us to drop <code>detachFromLane</code> from the system entirely, but I&#39;ll leave that up to you.</p>
<p>After these changes you should be able to drag notes to empty lanes.</p>
<h3 class="header"><a class="header-anchor" href="#fixing-editing-behavior-during-dragging" id="fixing-editing-behavior-during-dragging"></a><span class="text">Fixing Editing Behavior During Dragging</span><a class="header-anchor-select" href="#fixing-editing-behavior-during-dragging">#</a></h3>
<p>The current implementation has a small glitch. If you edit a note, you can still drag it around while it&#39;s being edited. This isn&#39;t ideal as it overrides the default behavior most people are used to. You cannot for instance double-click on an input to select all the text.</p>
<p>Fortunately, this is simple to fix. We&#39;ll need to use the <code>editing</code> state per each <code>Note</code> to adjust its behavior. First we need to pass <code>editing</code> state to an individual <code>Note</code>:</p>
<p><strong>app/components/Notes.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >,</span> onValueClick<span class="token punctuation" >,</span> onEdit<span class="token punctuation" >,</span> onDelete<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
    <span class="token operator" >&lt;</span>ul className<span class="token operator" >=</span><span class="token string" >"notes"</span><span class="token operator" >></span><span class="token punctuation" >{</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span>
<div class="leanpub-delete">
      <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span>
        onMove<span class="token operator" >=</span><span class="token punctuation" >{</span>LaneActions<span class="token punctuation" >.</span>move<span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
<div class="leanpub-insert">
      <span class="token operator" >&lt;</span>Note className<span class="token operator" >=</span><span class="token string" >"note"</span> id<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span> key<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>id<span class="token punctuation" >}</span>
        editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span> onMove<span class="token operator" >=</span><span class="token punctuation" >{</span>LaneActions<span class="token punctuation" >.</span>move<span class="token punctuation" >}</span><span class="token operator" >></span>
</div>
        <span class="token operator" >&lt;</span>Editable
          editing<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>editing<span class="token punctuation" >}</span>
          value<span class="token operator" >=</span><span class="token punctuation" >{</span>note<span class="token punctuation" >.</span>task<span class="token punctuation" >}</span>
          onValueClick<span class="token operator" >=</span><span class="token punctuation" >{</span>onValueClick<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span>onEdit<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span>
          onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span>onDelete<span class="token punctuation" >.</span><span class="token function" >bind</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> note<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span><span class="token punctuation" >}</span> <span class="token operator" >/</span><span class="token operator" >></span>
      <span class="token operator" >&lt;</span><span class="token operator" >/</span>Note<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>ul<span class="token operator" >></span>
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Next we need to take this into account while rendering:</p>
<p><strong>app/components/Note.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

@<span class="token function" >DragSource</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteSource<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >,</span> monitor<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDragSource<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  isDragging<span class="token punctuation" >:</span> monitor<span class="token punctuation" >.</span><span class="token function" >isDragging</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
@<span class="token function" >DropTarget</span><span class="token punctuation" >(</span>ItemTypes<span class="token punctuation" >.</span>NOTE<span class="token punctuation" >,</span> noteTarget<span class="token punctuation" >,</span> <span class="token punctuation" >(</span>connect<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  connectDropTarget<span class="token punctuation" >:</span> connect<span class="token punctuation" >.</span><span class="token function" >dropTarget</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >Note</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> connectDropTarget<span class="token punctuation" >,</span> isDragging<span class="token punctuation" >,</span>
      onMove<span class="token punctuation" >,</span> id<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>connectDragSource<span class="token punctuation" >,</span> connectDropTarget<span class="token punctuation" >,</span> isDragging<span class="token punctuation" >,</span>
      onMove<span class="token punctuation" >,</span> id<span class="token punctuation" >,</span> editing<span class="token punctuation" >,</span> <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>
    <span class="token comment" spellcheck="true">// Pass through if we are editing</span>
    <span class="token keyword" >const</span> dragSource <span class="token operator" >=</span> editing <span class="token operator" >?</span> a <span class="token operator" >=</span><span class="token operator" >></span> a <span class="token punctuation" >:</span> connectDragSource<span class="token punctuation" >;</span>
</div>

<div class="leanpub-delete">
    <span class="token keyword" >return</span> <span class="token function" >connectDragSource</span><span class="token punctuation" >(</span><span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >return</span> <span class="token function" >dragSource</span><span class="token punctuation" >(</span><span class="token function" >connectDropTarget</span><span class="token punctuation" >(</span>
</div>
      <span class="token operator" >&lt;</span>li style<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token punctuation" >{</span>
        opacity<span class="token punctuation" >:</span> isDragging <span class="token operator" >?</span> <span class="token number" >0</span> <span class="token punctuation" >:</span> <span class="token number" >1</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >}</span> <span class="token punctuation" >{</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>props<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token punctuation" >{</span>props<span class="token punctuation" >.</span>children<span class="token punctuation" >}</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>li<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>This small change gives us the behavior we want. If you try to edit a note now, the input should work as you might expect it to behave normally. Design-wise it was a good idea to keep <code>editing</code> state outside of <code>Editable</code>. If we hadn&#39;t done that, implementing this change would have been a lot harder as we would have had to extract the state outside of the component.</p>
<p>Now we have a Kanban table that is actually useful! We can create new lanes and notes, and edit and remove them. In addition we can move notes around. Mission accomplished!</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>In this chapter, you saw how to implement drag and drop for our little application. You can model sorting for lanes using the same technique. First, you mark the lanes to be draggable and droppable, then you sort out their ids, and finally, you&#39;ll add some logic to make it all work together. It should be considerably simpler than what we did with notes.</p>
<p>I encourage you to expand the application. The current implementation should work just as a starting point for something greater. Besides extending the DnD implementation, you can try adding more data to the system. You could also do something to the visual outlook. One option would be to try out various styling approaches discussed at the <em>Styling React</em> chapter.</p>
<p>To make it harder to break the application during development, you can also implement tests as discussed at <em>Testing React</em>. <em>Typing with React</em> discussed yet more ways to harden your code. Learning these approaches can be worthwhile. Sometimes it may be worth your while to design your applications test first. It is a valuable approach as it allows you to document your assumptions as you go.</p>
<p>In the next chapter, we&#39;ll set up a production level build for our application. You can use the techniques discussed in your own projects.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this chapter consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/images/kanban_photo.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack_react/from_notes_to_kanban">From Notes to Kanban</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/images/boots.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack_react/building_kanban">Building Kanban</a></div></div><div id="disqus_thread"></div></div><a class="next-page" href="/webpack_react/building_kanban" title="Building Kanban"><i class="icon-right-open"></i></a><a class="previous-page" href="/webpack_react/from_notes_to_kanban" title="From Notes to Kanban"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a class="" href="/">Home</a></div><div class="nav__link"><a class="" href="/blog">Read the blog</a></div><div class="nav__link"><a class="" href="https://leanpub.com/survivejs_webpack">Buy the full ebook</a></div><div class="nav__link"><a class="" href=""></a></div><div class="nav__link"><a class="" href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><div class="right ribbon github-fork-ribbon-wrapper"><div class="github-fork-ribbon" style="background-color:black;"><a href="https://github.com/survivejs/webpack_react/issues/new?title=Implementing Drag and Drop - " target="_blank">Submit feedback</a></div></div><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank">Mailing List</a></li><li><a href="https://gitter.im/survivejs/webpack_react" target="_blank">Gitter Chat</a></li><li><a href="https://github.com/survivejs/webpack_react" target="_blank">GitHub</a></li><li><a href="/atom.xml" target="_blank">Blog RSS</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank">Contact</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/survivejs200">SurviveJS - Webpack and React - v2.0.0</a></li><li><a class="blog-teaser" href="/blog/survivejs200-rc4">SurviveJS - Webpack and React - v2.0.0-rc4</a></li><li><a class="blog-teaser" href="/blog/towards-common-components">Towards a Common Component Definition</a></li><li><a class="blog-teaser" href="/blog/survivejs200-rc3">SurviveJS - Webpack and React - v2.0.0-rc3</a></li><li><a class="blog-teaser" href="/blog/survivejs200-rc2">SurviveJS - Webpack and React - v2.0.0-rc2</a></li><li><a class="blog-teaser" href="/blog/survivejs200-rc1">SurviveJS - Webpack and React - v2.0.0-rc1</a></li><li><a class="blog-teaser" href="/blog/codemod-interview">Codemod - Refactoring Code Programmatically - Interview with Ramana Venkata</a></li><li><a class="blog-teaser" href="/blog/2015-recap">2015 Recap</a></li><li><a class="blog-teaser" href="/blog/survivejs200-beta2">SurviveJS - Webpack and React - v2.0.0-beta2</a></li><li><a class="blog-teaser" href="/blog/whitestormjs-interview">WhitestormJS - Three.js Based Game Engine - Interview with Alexander Buzin</a></li></ul></div></div></div></footer><div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            room: 'survivejs/webpack_react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div></main></body></html>